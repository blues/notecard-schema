{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://raw.githubusercontent.com/blues/notecard-schema/master/card.location.mode.req.notecard.api.json",
    "title": "card.location.mode Request Application Programming Interface (API) Schema",
    "description": "Sets location-related configuration settings. Retrieves the current location mode when passed with no argument.",
    "type": "object",
    "version": "1.1.2",
    "apiVersion": "9.1.1",
    "skus": [
        "CELL",
        "CELL+WIFI",
        "LORA",
        "WIFI"
    ],
    "properties": {
        "delete": {
            "description": "Set to `true` to delete the last known location stored in the Notecard.",
            "type": "boolean"
        },
        "lat": {
            "description": "When in periodic or continuous mode, providing this value enables [geofencing](/notecard/notecard-walkthrough/time-and-location-requests#geofencing-with-the-notecard). The value you provide for this argument should be the latitude of the center of the geofence, in degrees. When in fixed mode, the value you provide for this argument should be the latitude location of the device itself, in degrees.",
            "type": "number",
            "default": "last known latitude"
        },
        "lon": {
            "description": "When in periodic or continuous mode, providing this value enables [geofencing](/notecard/notecard-walkthrough/time-and-location-requests#geofencing-with-the-notecard). The value you provide for this argument should be the longitude of the center of the geofence, in degrees. When in fixed mode, the value you provide for this argument should be the longitude location of the device itself, in degrees.",
            "type": "number",
            "default": "last known longitude"
        },
        "max": {
            "description": "Meters from a geofence center. Used to enable geofence location tracking.",
            "type": "integer"
        },
        "minutes": {
            "description": "When geofence is enabled, the number of minutes the device should be outside the geofence before the Notecard location is tracked.",
            "type": "integer",
            "default": 5
        },
        "mode": {
            "description": "Sets the location mode.",
            "type": "string",
            "enum": [
                "",
                "off",
                "periodic",
                "continuous",
                "fixed"
            ],
            "sub-descriptions": [
                {
                    "const": "",
                    "description": "Retrieves the current mode."
                },
                {
                    "const": "off",
                    "description": "Turns location mode off. Approximate location may still be [ascertained from Notehub](/notecard/notecard-walkthrough/time-and-location-requests#ascertaining-an-approximate-device-location)."
                },
                {
                    "const": "periodic",
                    "description": "Samples location at a specified interval, if the device has moved."
                },
                {
                    "const": "continuous",
                    "description": "Enables the Notecard's GPS/GNSS module for continuous sampling. When in continuous mode the Notecard samples a new GPS/GNSS reading for every new Note."
                },
                {
                    "const": "fixed",
                    "description": "Reports the location as a fixed location using the specified `lat` and `lon` coordinates. This is the only supported mode on Notecard LoRa."
                }
            ]
        },
        "seconds": {
            "description": "When in `periodic` mode, location will be sampled at this interval, if the Notecard detects motion. If seconds is < 300, during periods of sustained movement the Notecard will leave its onboard GPS/GNSS on continuously to avoid powering the module on and off repeatedly.",
            "type": "integer",
            "minimum": 0
        },
        "threshold": {
            "description": "When in `periodic` mode, the number of motion events (registered by the built-in accelerometer) required to trigger GPS to turn on.",
            "type": "integer",
            "default": 0,
            "minApiVersion": "3.4.1"
        },
        "vseconds": {
            "description": "In `periodic` mode, overrides `seconds` with a voltage-variable value.",
            "type": "string"
        },
        "req": {
            "description": "Request for the Notecard (expects response)",
            "const": "card.location.mode"
        },
        "cmd": {
            "description": "Command for the Notecard (no response)",
            "const": "card.location.mode"
        }
    },
    "oneOf": [
        {
            "required": [
                "req"
            ],
            "properties": {
                "req": {
                    "const": "card.location.mode"
                }
            }
        },
        {
            "required": [
                "cmd"
            ],
            "properties": {
                "cmd": {
                    "const": "card.location.mode"
                }
            }
        }
    ],
    "additionalProperties": false,
    "samples": [
        {
            "title": "Continuous Mode",
            "description": "Enable continuous GPS/GNSS sampling.",
            "json": "{\"req\": \"card.location.mode\", \"mode\": \"continuous\"}"
        },
        {
            "title": "Periodic Mode",
            "description": "Enable periodic location sampling at 1-hour intervals.",
            "json": "{\"req\": \"card.location.mode\", \"mode\": \"periodic\", \"seconds\": 3600}"
        },
        {
            "title": "Geofence Mode",
            "description": "Enable geofencing with specific location and radius.",
            "json": "{\"req\": \"card.location.mode\", \"mode\": \"periodic\", \"lat\": 42.5776, \"lon\": -70.87134, \"max\": 100, \"minutes\": 2}"
        },
        {
            "title": "Fixed Mode",
            "description": "Set a fixed location for the device.",
            "json": "{\"req\": \"card.location.mode\", \"mode\": \"fixed\", \"lat\": 42.5776, \"lon\": -70.87134}"
        }
    ]
}
