{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://raw.githubusercontent.com/blues/notecard-schema/master/card.io.req.notecard.api.json",
    "title": "card.io Request Application Programming Interface (API) Schema",
    "description": "Can be used to override the Notecard's I2C address from its default of `0x17` and change behaviors of the onboard LED and USB port.",
    "type": "object",
    "version": "1.1.2",
    "apiVersion": "9.1.1",
    "minApiVersion": "7.4.1",
    "skus": [
        "CELL",
        "CELL+WIFI",
        "LORA",
        "WIFI"
    ],
    "properties": {
        "i2c": {
            "description": "The alternate address to use for I2C communication. Pass `-1` to [reset](https://dev.blues.io/notecard/notecard-walkthrough/essential-requests/#resetting-request-argument-values) to the default address",
            "type": "integer"
        },
        "mode": {
            "description": "Used to control the Notecard's IO behavior, including USB port, LED, I2C master, NTN fallback.",
            "type": "string",
            "enum": [
                "-usb",
                "usb",
                "+usb",
                "+busy",
                "-busy",
                "i2c-master-disable",
                "i2c-master-enable",
                "+fallback",
                "-fallback"
            ],
            "sub-descriptions": [
                {
                    "const": "-usb",
                    "description": "Set to `\"-usb\"` to disable the Notecard's USB port. Re-enable the USB port with `\"usb\"` or `\"+usb\"`."
                },
                {
                    "const": "+busy",
                    "description": "If set to `\"+busy\"`, the Notecard's LED will be on when the Notecard is awake, and off when the Notecard goes to sleep.",
                    "minApiVersion": "7.4.1"
                },
                {
                    "const": "-busy",
                    "description": "Resets `\"+busy\"` to its default, making the onboard LED blink only during Notecard flash memory operations."
                },
                {
                    "const": "i2c-master-disable",
                    "description": "Disables Notecard acting as an I2C master. Re-enable by using `\"i2c-master-enable\"`.",
                    "minApiVersion": "9.1.1"
                },
                {
                    "const": "+fallback",
                    "description": "Setting `\"+fallback\"` while Notecard is paired with a Starnote device forces fallback mode: Wi-Fi and cellular are automatically failed over, and all traffic goes through NTN. This state persists across reboots and therefore is discouraged for use in production deployments because it can incur unexpectedly high satellite data costs.",
                    "minApiVersion": "8.2.1"
                },
                {
                    "const": "-fallback",
                    "description": "Resets `\"+fallback\"` to its default state, ensuring fallback mode is only enabled if cellular/Wi-Fi are not available."
                }
            ]
        },
        "req": {
            "description": "Request for the Notecard (expects response)",
            "const": "card.io"
        },
        "cmd": {
            "description": "Command for the Notecard (no response)",
            "const": "card.io"
        }
    },
    "oneOf": [
        {
            "required": [
                "req"
            ],
            "properties": {
                "req": {
                    "const": "card.io"
                }
            }
        },
        {
            "required": [
                "cmd"
            ],
            "properties": {
                "cmd": {
                    "const": "card.io"
                }
            }
        }
    ],
    "additionalProperties": false,
    "samples": [
        {
            "title": "Change I2C Address",
            "description": "Change the Notecard's I2C address from its default of `0x17` to `0x18`.",
            "json": "{\"req\": \"card.io\", \"i2c\": 24}"
        },
        {
            "title": "Keep LED On While Notecard Awake.",
            "description": "Keep the onboard LED on while the Notecard is awake.",
            "json": "{\"req\": \"card.io\", \"mode\": \"+busy\"}"
        },
        {
            "title": "Disable I2C Master.",
            "description": "Disable the Notecard from acting as an I2C master. Re-enable by using `\"i2c-master-enable\"`.",
            "json": "{\"req\": \"card.io\", \"mode\": \"i2c-master-disable\"}"
        },
        {
            "title": "Force Fallback Mode For Starnote.",
            "description": "Force the Notecard to enter fallback mode (cellular/Wi-Fi automatically failed over to NTN).",
            "json": "{\"req\": \"card.io\", \"mode\": \"+fallback\"}"
        }
    ]
}
